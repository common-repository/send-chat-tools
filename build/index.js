!function(){"use strict";var e={251:function(e,t,s){var o=s(196),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,s){var o,n={},l=null,d=null;for(o in void 0!==s&&(l=""+s),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,o)&&!r.hasOwnProperty(o)&&(n[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===n[o]&&(n[o]=t[o]);return{$$typeof:a,type:e,key:l,ref:d,props:n,_owner:c.current}}t.Fragment=n,t.jsx=l,t.jsxs=l},893:function(e,t,s){e.exports=s(251)},196:function(e){e.exports=window.React}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,s),n.exports}s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o={};!function(){s.d(o,{H:function(){return C}});var e=s(893),t=window.wp.components,a=window.wp.element,n=window.wp.i18n;const i=()=>{const s=[(0,n.__)("Send Chat Tools uses the WordPress REST API for setting loading.","send-chat-tools"),(0,n.__)("If you continue to see this error, the WordPress REST API may be disabled.","send-chat-tools"),(0,n.__)("The WordPress REST API can be set up in a plugin or in your theme's functions.php file.","send-chat-tools"),(0,n.__)("Please activate the WordPress REST API and try accessing it again.","send-chat-tools")];return(0,e.jsx)(t.Panel,{header:(0,n.__)("API connection failed.","send-chat-tools"),children:(0,e.jsx)(t.PanelBody,{children:s.map(((s,o)=>(0,e.jsx)(t.PanelRow,{children:s},o)))})})};var c=window.wp.apiFetch,r=s.n(c),l=Object.defineProperty,d=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,_=(e,t,s)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const u=(e,t)=>{const{apiData:s,setApiData:o}=(0,a.useContext)(C);return((e,t)=>{const[s,o]=(0,a.useState)(void 0),{apiData:i,setNoticeValue:c,setNoticeMessage:l,snackbarTimer:d}=(0,a.useContext)(C),h=(0,a.useRef)(!0);(0,a.useEffect)((()=>{h.current?h.current=!1:t&&t!==s&&(c(void 0),clearTimeout(d),o(t),r()({path:"/send-chat-tools/v1/update",method:"POST",data:{[e]:t[e]}}).then((()=>{c("sct_success"),l((0,n.__)("Success","send-chat-tools"))})).catch((()=>{c("sct_error"),l((0,n.__)("Error","send-chat-tools"))})))}),[i,e,t,l,c,d,s])})(e,s),{apiData:s,changeValue:a=>{const n=JSON.parse(JSON.stringify(((e,t)=>{for(var s in t||(t={}))h.call(t,s)&&_(e,s,t[s]);if(d)for(var s of d(t))m.call(t,s)&&_(e,s,t[s]);return e})({},s))),i=e=>{const s=e=>"string"==typeof e;t&&["use","send_author","comment_notify","update_notify","login_notify","rinker_notify"].includes(t)&&"boolean"==typeof a&&(n[e][t]=a),t&&"webhook_url"===t&&s(a)&&(n[e][t]=a),"chatwork"===e&&s(a)&&("api_token"===t&&(n.chatwork.api_token=a),"room_id"===t&&(n.chatwork.room_id=a))};"slack"===e?i("slack"):"discord"===e?i("discord"):"chatwork"===e?i("chatwork"):"object"==typeof a&&"target"in a&&("cron_time"===a.target.id?n.cron_time=a.target.value:"rinker_cron_time"===a.target.id&&(n.rinker_cron_time=a.target.value)),o(n)}}},p=s=>{const{itemKey:o,title:a}=s,{apiData:n,changeValue:i}=u(o);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("h4",{children:a}),n&&(0,e.jsx)(t.FormTokenField,{value:n.ignore_key,onChange:e=>i(e)})]})},x=()=>{const s=(0,n.__)("Rinker is not activated.","send-chat-tools"),o=(0,n.__)("Rinker is a very popular product management plug-in for Amazon and Rakuten.","send-chat-tools");return(0,e.jsx)("div",{className:"sct-rinker-notice",children:(0,e.jsxs)("p",{children:[s+" "+o," ",(0,e.jsx)("br",{}),(0,n.__)("Download","send-chat-tools")+" >>> ",(0,e.jsx)(t.ExternalLink,{href:"https://oyakosodate.com/rinker/",children:(0,n.__)("Rinker Official Web Site","send-chat-tools")})," / ",(0,e.jsx)(t.ExternalLink,{href:"https://oyayoi.fanbox.cc/",children:(0,n.__)("Rinker Official FANBOX","send-chat-tools")})]})})},f=t=>{const{itemKey:s,title:o,id:n,message:i}=t,{apiData:c,changeValue:r}=u(s),[l,d]=(0,a.useState)(""),{isRinkerActivated:h}=(0,a.useContext)(C);(0,a.useEffect)((()=>{c&&("cron_time"===s?d(c.cron_time):"rinker_cron_time"===s&&d(c.rinker_cron_time))}),[c,s]);const m=()=>"rinker_cron_time"===s;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("h4",{children:o}),c&&(0,e.jsx)("input",{id:n,className:"update-time",type:"time",disabled:m()&&!h,value:l,onChange:e=>r(e)}),i,m()&&!h&&(0,e.jsx)(x,{})]})},j=e=>{const{id:t}=e,[s,o]=(0,a.useState)(void 0),[i,c]=(0,a.useState)(""),[r,l]=(0,a.useState)(""),[d,h]=(0,a.useState)(""),[m,_]=(0,a.useState)(""),[u,p]=(0,a.useState)(void 0),[x,f]=(0,a.useState)(void 0),[j,k]=(0,a.useState)(""),[y,g]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const e=(e,t,s,a,n)=>{o(e),c(t),p(s),h(a),_(n)},s=e=>(0,n.sprintf)(/* translators: Chat tool name. */
(0,n.__)("Enable %s notifications.","send-chat-tools"),e.charAt(0).toUpperCase()+e.slice(1));"basic"===t?(l("basic"),h((0,n.__)("Basic settings","send-chat-tools"))):"slack"===t?e("slack",s(t),"webhook_url",(0,n.__)("Slack settings","send-chat-tools"),(0,n.__)("Slack Webhook URL","send-chat-tools")):"discord"===t?e("discord",s(t),"webhook_url",(0,n.__)("Discord settings","send-chat-tools"),(0,n.__)("Discord Webhook URL","send-chat-tools")):"chatwork"===t?(e("chatwork",s(t),"api_token",(0,n.__)("Chatwork settings","send-chat-tools"),(0,n.__)("Chatwork API token","send-chat-tools")),f("room_id"),k((0,n.__)("Chatwork Room ID","send-chat-tools"))):"logs"===t&&(l("logs"),h((0,n.__)("Logs","send-chat-tools")))}),[t]),(0,a.useEffect)((()=>{if(s){const e=[{itemKey:s,optionName:"use",label:i},{itemKey:s,optionName:"comment_notify",label:(0,n.__)("Notify when new comments are received.","send-chat-tools")},{itemKey:s,optionName:"send_author",label:(0,n.__)("If you comment while logged into WordPress,you will not be notified of your own comment.","send-chat-tools")},{itemKey:s,optionName:"update_notify",label:(0,n.__)("Notify you when there are updates to WordPress Core, themes, and plugins.","send-chat-tools")},{itemKey:s,optionName:"login_notify",label:(0,n.__)("Notify you when a WordPress user logs in.","send-chat-tools")},{itemKey:s,optionName:"rinker_notify",label:(0,n.__)("Notify you when an item managed by Rinkerbecomes end-of-life on Amazon or Rakuten.","send-chat-tools")}];g(e)}}),[s,i]),{itemKey:s,componentName:r,titleText:d,textLabel:m,tabItems:y,chatworkRoomId:x,chatworkText:j,apiOptionName:u}},k=s=>{const{titleText:o}=j(s),a=(0,n.__)("Update and Rinker notifications are made using wp-cron.","send-chat-tools"),i=(0,n.__)("wp-cron will be executed on the first access after this time.","send-chat-tools");return(0,e.jsxs)("div",{className:"sct-wrapper",children:[(0,e.jsx)("h3",{children:o}),(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(f,{itemKey:"cron_time",title:(0,n.__)("Set time to check for updates","send-chat-tools"),id:"cron_time",message:(0,n.__)("Time to send Updates notifications","send-chat-tools")})}),(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(f,{itemKey:"rinker_cron_time",title:(0,n.__)("Set time to check for Rinker exists items","send-chat-tools"),id:"rinker_cron_time",message:(0,n.__)("Time to send Rinker end-of-sale notifications","send-chat-tools")})}),(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(t.Tip,{children:a+" "+i})}),(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(p,{itemKey:"ignore_key",title:(0,n.__)("Theme/plugin key to remove update notifications","send-chat-tools")})})]})},y=s=>{const{itemKey:o}=s,{apiData:i}=(0,a.useContext)(C),[c,r]=(0,a.useState)(void 0);return(0,a.useEffect)((()=>{i&&r(i[o].log)}),[o,i]),(0,e.jsxs)("div",{className:"sct-tools-log-wrapper",children:[(0,e.jsx)("h4",{children:`${(0,n.__)("Logs","send-chat-tools")} (\n\t\t\t\t${(0,n.__)("Last three cases","send-chat-tools")} )`}),c&&Object.entries(c).map((([s,o],a)=>(0,e.jsxs)(t.Card,{className:"sct-tools-log",children:[(0,e.jsx)(t.CardHeader,{children:`${(0,n.__)("Commenter","send-chat-tools")}: ${o.commenter} <${o.email}>`}),(0,e.jsx)(t.CardBody,{className:"sct-tools-log-body",children:o.comment}),(0,e.jsxs)(t.CardFooter,{className:"sct-tools-log-footer",children:[(0,e.jsx)("span",{className:"sct-tools-log-footer-comment_id",children:`${(0,n.__)("Comment ID","send-chat-tools")}: ${o.comment}`}),(0,e.jsx)("span",{className:"sct-tools-log-footer-status",children:`${(0,n.__)("Status","send-chat-tools")}: ${o.status}`}),(0,e.jsx)("span",{className:"sct-tools-log-footer-date",children:`${(0,n.__)("Date","send-chat-tools")}: ${s}`})]})]},a)))]})},g=()=>{const{items:s,copyLogs:o}=(()=>{const{apiData:e,setNoticeValue:t,setNoticeMessage:s,setSnackbarTimer:o}=(0,a.useContext)(C),i=[{icon:"clipboard",key:"clipboard",text:(0,n.__)("Copy to clipboard","send-chat-tools")},{icon:"media-text",key:"text",text:(0,n.__)("Export text","send-chat-tools")},{icon:"media-spreadsheet",key:"csv",text:(0,n.__)("Export CSV","send-chat-tools")}];return{apiData:e,items:i,copyLogs:a=>{if(e){t(void 0),o(0);const i="csv"===a?",":" ",c={status:"csv"===a?"":"Status:",type:"csv"===a?"":"Type:",tool:"csv"===a?"":"Tool:",date:"csv"===a?"":"Date:"},r=Object.values(e.logs).map((e=>{var t,s;return`${c.status}${e.status}${i}${c.tool}${s=e.tool,"1"===s?"Slack":"2"===s?"Discord":"3"===s?"Chatwork":null}${i}${c.type}${t=e.type,"1"===t?"Comment":"2"===t?"Update":"3"===t?"Developer":null}${i}${c.date}${e.send_date}\n`}));switch(a){case"clipboard":navigator.clipboard.writeText(r.join(""));break;case"text":case"csv":((e,t)=>{"csv"===t&&e.unshift("Status,Type,Tool,Date\n");const s=new Blob(e,{type:`text/${t}`}),o=document.createElement("a");o.href=URL.createObjectURL(s),o.download=`log.${t}`,o.click()})(r,a)}"clipboard"===a&&(t("sct_success"),s((0,n.__)("Copied","send-chat-tools")))}}}})();return(0,e.jsx)(t.Dropdown,{className:"sct-logs__export-button",popoverProps:{placement:"right-start"},renderToggle:({isOpen:s,onToggle:o})=>(0,e.jsx)(t.Button,{onClick:o,"aria-expanded":s,children:(0,e.jsx)("span",{className:"dashicons dashicons-ellipsis"})}),renderContent:()=>(0,e.jsx)(t.MenuGroup,{children:s.map(((s,a)=>(0,e.jsx)(t.MenuItem,{icon:(0,e.jsx)(t.Dashicon,{icon:s.icon}),onClick:()=>o(s.key),children:s.text},a)))})})},b=()=>{const{apiData:s}=(0,a.useContext)(C),o=t=>{const s=(t,s)=>{const o=s?"success":"error";return(0,e.jsx)("span",{className:`res-${o}`,children:t})};switch(t){case 200:case 204:return s((0,n.__)("Success","send-chat-tools"),!0);case 1e3:default:return s((0,n.__)("Could not communicate.","send-chat-tools"),!1);case 1001:return s((0,n.__)("Webhook URL/API Token not entered.","send-chat-tools"),!1);case 1002:return s((0,n.__)("RoomID not entered.","send-chat-tools"),!1);case 1003:return s((0,n.__)("API system value is incorrect.","send-chat-tools"),!1)}};return(0,e.jsxs)(t.Card,{className:"sct-logs",children:[(0,e.jsxs)(t.CardHeader,{children:[(0,n.__)("Communication logs","send-chat-tools"),(0,e.jsx)(g,{})]}),(0,e.jsx)(t.CardBody,{children:(0,e.jsxs)("table",{className:"sct-logs-table",children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:(0,n.__)("Date","send-chat-tools")}),(0,e.jsx)("th",{children:(0,n.__)("Tool","send-chat-tools")}),(0,e.jsx)("th",{children:(0,n.__)("Type","send-chat-tools")}),(0,e.jsx)("th",{children:(0,n.__)("Status","send-chat-tools")}),(0,e.jsx)("th",{children:(0,n.__)("Detail","send-chat-tools")})]}),s&&Object.values(s.logs).map(((t,s)=>{return(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:t.send_date}),(0,e.jsx)("td",{children:(n=t.tool,"1"===n?"Slack":"2"===n?"Discord":"3"===n?"Chatwork":null)}),(0,e.jsx)("td",{children:(a=t.type,"1"===a?"Comment":"2"===a?"Update":"3"===a?"Developer":"4"===a?"Login":"5"===a?"Rinker":null)}),(0,e.jsx)("td",{children:t.status}),(0,e.jsx)("td",{children:o(t.status)})]},s);var a,n}))]})}),(0,e.jsx)(t.CardFooter,{children:(0,e.jsxs)("p",{children:["Total ",s&&Object.keys(s.logs).length," items."]})})]})},v=s=>{const{itemKey:o,optionName:n,label:i}=s,{apiData:c,changeValue:r}=u(o,n),[l,d]=(0,a.useState)("");return(0,a.useEffect)((()=>{c&&("slack"===o||"discord"===o?d(c[o].webhook_url):"api_token"===n?d(c.chatwork.api_token):"room_id"===n&&d(c.chatwork.room_id))}),[o,n,c]),(0,e.jsx)(e.Fragment,{children:c&&(0,e.jsx)(t.TextControl,{label:i,value:l,onChange:e=>r(e)})})},w=s=>{const{itemKey:o,optionName:i,label:c}=s,{apiData:r,changeValue:l}=u(o,i),{isRinkerActivated:d}=(0,a.useContext)(C),[h,m]=(0,a.useState)(!1);(0,a.useEffect)((()=>{r&&m(r[o].use)}),[o,r]);const _={use:(0,n.sprintf)(/* translators: Chat tool name. */
(0,n.__)("Use %s","send-chat-tools"),o.charAt(0).toUpperCase()+o.slice(1)),comment_notify:(0,n.__)("Comment notification","send-chat-tools"),update_notify:(0,n.__)("Update notification","send-chat-tools"),login_notify:(0,n.__)("Login notification","send-chat-tools"),rinker_notify:(0,n.__)("Rinker notification","send-chat-tools")},p=()=>"rinker_notify"===i;return(0,e.jsxs)(e.Fragment,{children:[r&&(0,e.jsxs)("section",{children:["send_author"!==i&&(0,e.jsx)("h4",{children:_[i]}),(0,e.jsx)(t.ToggleControl,{label:c,checked:r[o][i],disabled:"use"!==i&&!h||p()&&!d,onChange:e=>{l(e)}})]}),p()&&!d&&(0,e.jsx)(x,{})]})},N=t=>{const{itemKey:s,componentName:o,titleText:a,textLabel:n,tabItems:i,chatworkRoomId:c,chatworkText:r,apiOptionName:l}=j(t);return(0,e.jsxs)("div",{className:"sct-wrapper",children:[(0,e.jsx)("h3",{children:a}),s&&(0,e.jsx)("div",{className:"sct-items",children:Object.values(i).map(((t,s)=>(0,e.jsx)(w,{itemKey:t.itemKey,optionName:t.optionName,label:t.label},s)))}),s&&l&&(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(v,{itemKey:s,optionName:l,label:n})}),s&&c&&(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(v,{itemKey:s,optionName:c,label:r})}),s&&(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(y,{itemKey:s})}),"logs"===o&&(0,e.jsx)("div",{className:"sct-items",children:(0,e.jsx)(b,{})})]})},S=()=>{const s=[{name:"basic",title:(0,n.__)("Basic Settings","send-chat-tools"),className:"tab-basic"},{name:"slack",title:(0,n.__)("Slack","send-chat-tools"),className:"tab-slack"},{name:"discord",title:(0,n.__)("Discord","send-chat-tools"),className:"tab-discord"},{name:"chatwork",title:(0,n.__)("Chatwork","send-chat-tools"),className:"tab-chatwork"},{name:"logs",title:(0,n.__)("Logs","send-chat-tools"),className:"tab-logs"}];return(0,e.jsx)(t.TabPanel,{activeClass:"active-tab",className:"settings-tab",tabs:s,children:t=>"basic"!==t.name?(0,e.jsx)(N,{id:t.name,title:t.title}):(0,e.jsx)(k,{id:t.name,title:t.title})})},C=(0,a.createContext)({}),T=()=>{const[s,o]=(0,a.useState)(void 0),[c,l]=(0,a.useState)(!1),[d,h]=(0,a.useState)(void 0),[m,_]=(0,a.useState)(""),[u,p]=(0,a.useState)(0),[x,f]=(0,a.useState)(!1);return((e,t,s)=>{(0,a.useEffect)((()=>{r()({path:"/send-chat-tools/v1/options"}).then((s=>{t(!1),e(s)})).catch((()=>{t(!0)}))}),[e,t]),(0,a.useEffect)((()=>{r()({path:"/send-chat-tools/v1/get-rinker-activated"}).then((e=>{t(!1),s(e)})).catch((()=>{t(!0)}))}),[s,t])})(o,l,f),(0,a.useEffect)((()=>{d&&p(window.setTimeout((()=>{h(void 0)}),4e3))}),[d]),(0,e.jsxs)("div",{id:"sct-wrap",children:[(0,e.jsx)("h1",{children:(0,n.__)("Send Chat Tools Settings","send-chat-tools")}),d&&(0,e.jsx)(t.Snackbar,{className:d,children:m}),s&&(0,e.jsx)(C.Provider,{value:{apiData:s,setApiData:o,setApiError:l,setNoticeValue:h,setNoticeMessage:_,snackbarTimer:u,setSnackbarTimer:p,isRinkerActivated:x},children:(0,e.jsx)(S,{})}),!s&&!c&&(0,e.jsx)(t.Spinner,{}),c&&(0,e.jsx)(i,{})]})};(0,a.render)((0,e.jsx)(T,{}),document.getElementById("send-chat-tools-settings"))}()}();